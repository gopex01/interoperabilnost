<div class="filter-section">
  <div class="filter-container">
    <h3>Filtriraj zadatke</h3>
    <div class="controls">
      <select #yearSelect (change)="onFilterChange(yearSelect.value, monthSelect.value)">
        <option value="2024">2024. godina</option>
        <option value="2025">2025. godina</option>
        <option value="2026">2026. godina</option>
      </select>

      <select #monthSelect (change)="onFilterChange(yearSelect.value, monthSelect.value)">
        <option value="0">Januar</option>
        <option value="1">Februar</option>
        <option value="2">Mart</option>
        <option value="3">April</option>
        <option value="4">Maj</option>
        <option value="5">Jun</option>
        <option value="6">Jul</option>
        <option value="7">Avgust</option>
        <option value="8">Septembar</option>
        <option value="9">Oktobar</option>
        <option value="10">Novembar</option>
        <option value="11">Decembar</option>
      </select>
      
      <button class="btn-reset" (click)="resetFilter()">PrikaÅ¾i sve</button>
    </div>
  </div>
</div>

<div class="tasks-wrapper">
  <div class="tasks-container">
    @for(task of pagedTasks(); track task.id){
      <div class="task-card">
        <div class="task-header">
          <h3>{{task.title}}</h3>
          <span class="status-indicator" 
                [class.todo]="task.status === 1" 
                [class.ongoing]="task.status === 2" 
                [class.done]="task.status === 3">
            @if(task.status === 1) { Planirano }
            @else if(task.status === 2) { U toku }
            @else if(task.status === 3) { ZavrÅ¡eno }
          </span>
        </div>

        <p class="task-desc">{{task.description}}</p>

        <div class="task-footer">
          <div class="dates">
            <div class="date-box">
              <span class="date-label">OD:</span> {{task.date_from | date:'dd.MM.yyyy.'}}
            </div>
            @if(task.date_to){
              <div class="date-box">
                <span class="date-label">DO:</span> {{task.date_to | date:'dd.MM.yyyy.'}}
              </div>
            }
          </div>

          <div class="actions">
            <button class="btn-icon edit" title="Izmeni" (click)="editTask(task)">âœï¸</button>
            <button class="btn-icon delete" title="ObriÅ¡i" (click)="deleteTask(task)">ğŸ—‘ï¸</button>
          </div>
        </div>
      </div>
    } @empty {
      <div class="empty-state">
        <p>Nema pronaÄ‘enih taskova za izabrani period. ğŸš€</p>
      </div>
    }
  </div>

  @if (totalPages() > 1) {
    <div class="pagination">
      <button class="page-btn nav" [disabled]="currentPage() === 1" (click)="setPage(currentPage() - 1)">
        &laquo;
      </button>

      <div class="page-numbers">
        @for (p of [].constructor(totalPages()); track $index) {
          <button 
            class="page-btn"
            [class.active]="currentPage() === $index + 1"
            (click)="setPage($index + 1)">
            {{ $index + 1 }}
          </button>
        }
      </div>

      <button class="page-btn nav" [disabled]="currentPage() === totalPages()" (click)="setPage(currentPage() + 1)">
        &raquo;
      </button>
    </div>
  }
</div>